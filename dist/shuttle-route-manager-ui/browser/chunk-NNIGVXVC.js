import{a as W}from"./chunk-OGM6BETX.js";import{a as Q}from"./chunk-HNKISDOU.js";import{a as J}from"./chunk-TGDMD2NI.js";import{a as te}from"./chunk-VNNXU67K.js";import{b as P,c as S,d as j,e as z,g as H,i as A,j as $,k as q,l as K,m as Y,q as U,s as Z}from"./chunk-C3YQDD43.js";import"./chunk-K2W5W2RN.js";import{Ba as M,Ga as F,Ib as O,Jb as B,Ka as x,Kb as G,Pb as N,Ra as m,Sa as t,Ta as i,U as k,Ua as d,V as _,W as u,X as p,Xa as E,Ya as y,Za as c,a as R,cb as a,d as ee,db as h,eb as v,fb as T,gb as V,mb as L,ta as o,wb as D}from"./chunk-5JI3WXRX.js";var f=ee(te());var ie=(n,r,e)=>({"bg-green-500":n,"bg-red-500":r,"bg-blue-500":e});function re(n,r){if(n&1&&(t(0,"div",12),u(),t(1,"svg",13),d(2,"path",14),i(),p(),t(3,"span"),a(4),i()()),n&2){let e=c();o(4),h(e.successMessage)}}function ne(n,r){if(n&1&&(t(0,"div",15),u(),t(1,"svg",13),d(2,"path",16),i(),p(),t(3,"span"),a(4),i()()),n&2){let e=c();o(4),h(e.errorMessage)}}function ae(n,r){n&1&&(t(0,"div",17)(1,"div",18),u(),t(2,"svg",19),d(3,"circle",20)(4,"path",21),i(),p(),t(5,"p",22),a(6,"Y\xFCkleniyor..."),i()()())}function oe(n,r){if(n&1){let e=E();t(0,"tr",32)(1,"td",33)(2,"div",34)(3,"div",35),u(),t(4,"svg",36),d(5,"path",37),i()(),p(),t(6,"div")(7,"p",38),a(8),i()()()(),t(9,"td",33)(10,"div",39)(11,"div",40),u(),t(12,"svg",41),d(13,"path",42)(14,"path",43),i(),p(),t(15,"span"),a(16),i()(),t(17,"div",40),u(),t(18,"svg",44),d(19,"path",42)(20,"path",43),i(),p(),t(21,"span"),a(22),i()()()(),t(23,"td",33)(24,"div",45),u(),t(25,"svg",46),d(26,"path",47),i(),p(),t(27,"span",48),a(28),i()()(),t(29,"td",33)(30,"div",45),u(),t(31,"svg",49),d(32,"path",50),i(),p(),t(33,"span",48),a(34),i()()(),t(35,"td",33)(36,"span",51),a(37),i()(),t(38,"td",33)(39,"span",52),a(40),i()(),t(41,"td",33)(42,"button",53),y("click",function(){let s=k(e).$implicit,b=c(2);return _(b.openDetailModal(s))}),u(),t(43,"svg",54),d(44,"path",37),i(),a(45),i()(),p(),t(46,"td",55)(47,"div",56)(48,"button",57),y("click",function(){let s=k(e).$implicit,b=c(2);return _(b.openEditModal(s))}),u(),t(49,"svg",5),d(50,"path",58),i()(),p(),t(51,"button",59),y("click",function(){let s=k(e).$implicit,b=c(2);return _(b.openDeleteModal(s))}),u(),t(52,"svg",5),d(53,"path",60),i()()()()()}if(n&2){let e=r.$implicit,l=c(2);o(8),h(e.name),o(8),h(e.startPoint),o(6),h(e.endPoint),o(6),h(l.formatTime(e.morningStartTime)),o(6),h(l.formatTime(e.eveningStartTime)),o(3),v(" ",(e.bus==null?null:e.bus.plateNo)||l.getBusName(e.busId)," "),o(3),v(" ",(e.driver==null?null:e.driver.fullName)||l.getDriverName(e.driverId)," "),o(5),v(" ",l.getStopCount(e)," Durak "),o(3),m("disabled",l.isLoading),o(3),m("disabled",l.isLoading)}}function le(n,r){if(n&1){let e=E();t(0,"div",61),u(),t(1,"svg",62),d(2,"path",37),i(),p(),t(3,"h3",63),a(4,"Hen\xFCz rota yok"),i(),t(5,"p",64),a(6,"\u0130lk rotan\u0131z\u0131 ekleyerek ba\u015Flay\u0131n"),i(),t(7,"button",65),y("click",function(){k(e);let s=c(2);return _(s.openAddModal())}),a(8," Rota Ekle "),i()()}}function se(n,r){if(n&1&&(t(0,"div",23)(1,"div",24)(2,"table",25)(3,"thead",26)(4,"tr")(5,"th",27),a(6," Rota Ad\u0131 "),i(),t(7,"th",27),a(8," Ba\u015Flang\u0131\xE7 - Biti\u015F "),i(),t(9,"th",27),a(10," Sabah Saati "),i(),t(11,"th",27),a(12," Ak\u015Fam Saati "),i(),t(13,"th",27),a(14," Servis "),i(),t(15,"th",27),a(16," \u015Eof\xF6r "),i(),t(17,"th",27),a(18," Duraklar "),i(),t(19,"th",28),a(20," \u0130\u015Flemler "),i()()(),t(21,"tbody",29),x(22,oe,54,10,"tr",30),i()()(),x(23,le,9,0,"div",31),i()),n&2){let e=c();o(22),m("ngForOf",e.routes),o(),m("ngIf",e.routes.length===0)}}function de(n,r){if(n&1&&(t(0,"div",94),u(),t(1,"svg",13),d(2,"path",14),i(),p(),t(3,"span"),a(4),i()()),n&2){let e=c(2);o(4),h(e.successMessage)}}function me(n,r){if(n&1&&(t(0,"div",95),u(),t(1,"svg",13),d(2,"path",16),i(),p(),t(3,"span"),a(4),i()()),n&2){let e=c(2);o(4),h(e.errorMessage)}}function ue(n,r){if(n&1&&(t(0,"p",96),u(),t(1,"svg",97),d(2,"path",98),i(),a(3),i()),n&2){let e=c(2);o(3),v(" ",e.getErrorMessage("name")," ")}}function ce(n,r){if(n&1&&(t(0,"p",96),u(),t(1,"svg",97),d(2,"path",98),i(),a(3),i()),n&2){let e=c(2);o(3),v(" ",e.getErrorMessage("startPoint")," ")}}function ge(n,r){if(n&1&&(t(0,"p",96),u(),t(1,"svg",97),d(2,"path",98),i(),a(3),i()),n&2){let e=c(2);o(3),v(" ",e.getErrorMessage("endPoint")," ")}}function pe(n,r){if(n&1&&(t(0,"p",96),u(),t(1,"svg",97),d(2,"path",98),i(),a(3),i()),n&2){let e=c(2);o(3),v(" ",e.getErrorMessage("morningStartTime")," ")}}function xe(n,r){if(n&1&&(t(0,"p",96),u(),t(1,"svg",97),d(2,"path",98),i(),a(3),i()),n&2){let e=c(2);o(3),v(" ",e.getErrorMessage("eveningStartTime")," ")}}function ve(n,r){if(n&1&&(t(0,"option",99),a(1),i()),n&2){let e=r.$implicit;m("value",e.id),o(),V(" ",e.plateNo," - ",e.brand," ",e.model," ")}}function be(n,r){if(n&1&&(t(0,"p",96),u(),t(1,"svg",97),d(2,"path",98),i(),a(3),i()),n&2){let e=c(2);o(3),v(" ",e.getErrorMessage("busId")," ")}}function he(n,r){if(n&1&&(t(0,"option",99),a(1),i()),n&2){let e=r.$implicit;m("value",e.id),o(),T(" ",e.firstName," ",e.lastName," ")}}function fe(n,r){if(n&1&&(t(0,"p",96),u(),t(1,"svg",97),d(2,"path",98),i(),a(3),i()),n&2){let e=c(2);o(3),v(" ",e.getErrorMessage("driverId")," ")}}function ye(n,r){n&1&&(u(),t(0,"svg",100),d(1,"circle",20)(2,"path",21),i())}function ke(n,r){if(n&1){let e=E();t(0,"div",66)(1,"div",67)(2,"div",68)(3,"h2",69),a(4),i(),t(5,"button",70),y("click",function(){k(e);let s=c();return _(s.closeModal())}),u(),t(6,"svg",71),d(7,"path",72),i()()(),p(),t(8,"div",73),x(9,de,5,1,"div",74)(10,me,5,1,"div",75),t(11,"form",76),y("ngSubmit",function(){k(e);let s=c();return _(s.onSubmit())}),t(12,"div")(13,"label",77),a(14," Rota Ad\u0131 "),t(15,"span",78),a(16,"*"),i()(),d(17,"input",79),x(18,ue,4,1,"p",80),i(),t(19,"div",81)(20,"div")(21,"label",77),a(22," Ba\u015Flang\u0131\xE7 Noktas\u0131 "),t(23,"span",78),a(24,"*"),i()(),d(25,"input",82),x(26,ce,4,1,"p",80),i(),t(27,"div")(28,"label",77),a(29," Biti\u015F Noktas\u0131 "),t(30,"span",78),a(31,"*"),i()(),d(32,"input",83),x(33,ge,4,1,"p",80),i()(),t(34,"div",81)(35,"div")(36,"label",77),a(37," Sabah Ba\u015Flama Saati "),t(38,"span",78),a(39,"*"),i()(),d(40,"input",84),x(41,pe,4,1,"p",80),i(),t(42,"div")(43,"label",77),a(44," Ak\u015Fam Ba\u015Flama Saati "),t(45,"span",78),a(46,"*"),i()(),d(47,"input",85),x(48,xe,4,1,"p",80),i()(),t(49,"div",81)(50,"div")(51,"label",77),a(52," Servis "),t(53,"span",78),a(54,"*"),i()(),t(55,"select",86)(56,"option",87),a(57,"Servis Se\xE7iniz"),i(),x(58,ve,2,4,"option",88),i(),x(59,be,4,1,"p",80),i(),t(60,"div")(61,"label",77),a(62," \u015Eof\xF6r "),t(63,"span",78),a(64,"*"),i()(),t(65,"select",89)(66,"option",87),a(67,"\u015Eof\xF6r Se\xE7iniz"),i(),x(68,he,2,3,"option",88),i(),x(69,fe,4,1,"p",80),i()(),t(70,"div",90)(71,"button",91),y("click",function(){k(e);let s=c();return _(s.closeModal())}),a(72," \u0130ptal "),i(),t(73,"button",92),x(74,ye,3,0,"svg",93),a(75),i()()()()()()}if(n&2){let e,l,s,b,w,C,I,g=c();o(4),v(" ",g.isEditMode?"Rota D\xFCzenle":"Yeni Rota Ekle"," "),o(),m("disabled",g.isLoading),o(4),m("ngIf",g.successMessage),o(),m("ngIf",g.errorMessage),o(),m("formGroup",g.routeForm),o(7),m("ngIf",((e=g.routeForm.get("name"))==null?null:e.invalid)&&((e=g.routeForm.get("name"))==null?null:e.touched)),o(8),m("ngIf",((l=g.routeForm.get("startPoint"))==null?null:l.invalid)&&((l=g.routeForm.get("startPoint"))==null?null:l.touched)),o(7),m("ngIf",((s=g.routeForm.get("endPoint"))==null?null:s.invalid)&&((s=g.routeForm.get("endPoint"))==null?null:s.touched)),o(8),m("ngIf",((b=g.routeForm.get("morningStartTime"))==null?null:b.invalid)&&((b=g.routeForm.get("morningStartTime"))==null?null:b.touched)),o(7),m("ngIf",((w=g.routeForm.get("eveningStartTime"))==null?null:w.invalid)&&((w=g.routeForm.get("eveningStartTime"))==null?null:w.touched)),o(10),m("ngForOf",g.buses),o(),m("ngIf",((C=g.routeForm.get("busId"))==null?null:C.invalid)&&((C=g.routeForm.get("busId"))==null?null:C.touched)),o(9),m("ngForOf",g.drivers),o(),m("ngIf",((I=g.routeForm.get("driverId"))==null?null:I.invalid)&&((I=g.routeForm.get("driverId"))==null?null:I.touched)),o(2),m("disabled",g.isLoading),o(2),m("disabled",g.isLoading||g.routeForm.invalid),o(),m("ngIf",g.isLoading),o(),v(" ",g.isLoading?"Kaydediliyor...":g.isEditMode?"G\xFCncelle":"Kaydet"," ")}}function _e(n,r){n&1&&(t(0,"div",115)(1,"div",18),u(),t(2,"svg",19),d(3,"circle",20)(4,"path",21),i(),p(),t(5,"p",22),a(6,"Duraklar y\xFCkleniyor..."),i()()())}function Se(n,r){n&1&&(t(0,"div",116),u(),t(1,"svg",117),d(2,"path",118),i(),p(),t(3,"p"),a(4,"Bu rotada hen\xFCz durak yok"),i()())}function we(n,r){if(n&1&&(t(0,"div",119)(1,"div",120)(2,"div",121),a(3),i(),t(4,"div",122)(5,"p",123),a(6),i(),t(7,"p",124),a(8),i(),t(9,"div",125)(10,"div",126),u(),t(11,"svg",127),d(12,"path",47),i(),p(),t(13,"span"),a(14),i()(),t(15,"div",128),u(),t(16,"svg",127),d(17,"path",50),i(),p(),t(18,"span"),a(19),i()()()()()()),n&2){let e=r.$implicit,l=r.index,s=c(2);o(2),m("ngClass",L(7,ie,l===0,l===s.routeStops.length-1,l!==0&&l!==s.routeStops.length-1)),o(),v(" ",e.sequenceNumber," "),o(3),h(e.address),o(2),T("",e.district,", ",e.city),o(6),h(s.formatTime(e.estimatedArrivalTimeMorning)),o(5),h(s.formatTime(e.estimatedArrivalTimeEvening))}}function Ce(n,r){if(n&1){let e=E();t(0,"div",66)(1,"div",101)(2,"div",102)(3,"div")(4,"h2",69),a(5),i(),t(6,"p",103),a(7),i()(),t(8,"button",104),y("click",function(){k(e);let s=c();return _(s.closeDetailModal())}),u(),t(9,"svg",71),d(10,"path",72),i()()(),p(),t(11,"div",105)(12,"div",106),d(13,"div",107),x(14,_e,7,0,"div",108),i(),t(15,"div",109)(16,"h3",110),u(),t(17,"svg",111),d(18,"path",42)(19,"path",43),i(),a(20),i(),x(21,Se,5,0,"div",112),p(),t(22,"div",113),x(23,we,20,11,"div",114),i()()()()()}if(n&2){let e=c();o(5),h(e.selectedRoute==null?null:e.selectedRoute.name),o(2),T(" ",e.selectedRoute==null?null:e.selectedRoute.startPoint," \u2192 ",e.selectedRoute==null?null:e.selectedRoute.endPoint," "),o(7),m("ngIf",e.isLoadingStops),o(6),v(" Duraklar (",e.routeStops.length,") "),o(),m("ngIf",e.routeStops.length===0&&!e.isLoadingStops),o(2),m("ngForOf",e.routeStops)}}function Me(n,r){n&1&&(u(),t(0,"svg",100),d(1,"circle",20)(2,"path",21),i())}function Ee(n,r){n&1&&(u(),t(0,"svg",5),d(1,"path",60),i())}function Ie(n,r){if(n&1){let e=E();t(0,"div",66)(1,"div",129)(2,"div",130)(3,"div",34)(4,"div",131),u(),t(5,"svg",132),d(6,"path",133),i()(),p(),t(7,"h2",134),a(8," Rotay\u0131 Sil "),i()(),t(9,"button",70),y("click",function(){k(e);let s=c();return _(s.closeDeleteModal())}),u(),t(10,"svg",71),d(11,"path",72),i()()(),p(),t(12,"div",73)(13,"p",135)(14,"span",136),a(15),i(),a(16," adl\u0131 rotay\u0131 silmek istedi\u011Finizden emin misiniz? "),i(),t(17,"p",137),a(18," Bu i\u015Flem geri al\u0131namaz. "),i()(),t(19,"div",138)(20,"button",139),y("click",function(){k(e);let s=c();return _(s.closeDeleteModal())}),a(21," \u0130ptal "),i(),t(22,"button",140),y("click",function(){k(e);let s=c();return _(s.confirmDelete())}),x(23,Me,3,0,"svg",93)(24,Ee,2,0,"svg",141),a(25),i()()()()}if(n&2){let e=c();o(9),m("disabled",e.isDeleting),o(6),v('"',e.routeToDelete==null?null:e.routeToDelete.name,'"'),o(5),m("disabled",e.isDeleting),o(2),m("disabled",e.isDeleting),o(),m("ngIf",e.isDeleting),o(),m("ngIf",!e.isDeleting),o(),v(" ",e.isDeleting?"Siliniyor...":"Evet, Sil"," ")}}var X=class n{constructor(r,e,l,s,b){this.routeService=r;this.busService=e;this.driverService=l;this.fb=s;this.cdr=b;this.routeForm=this.fb.group({name:["",[S.required,S.minLength(3)]],startPoint:["",[S.required]],endPoint:["",[S.required]],morningStartTime:["",[S.required]],eveningStartTime:["",[S.required]],busId:["",[S.required]],driverId:["",[S.required]]})}routes=[];buses=[];drivers=[];isLoading=!1;errorMessage="";successMessage="";isModalOpen=!1;isEditMode=!1;routeForm;selectedRouteId=null;isDetailModalOpen=!1;selectedRoute=null;routeStops=[];map=null;isLoadingStops=!1;isDeleteModalOpen=!1;routeToDelete=null;isDeleting=!1;ngOnInit(){this.loadRoutes(),this.loadBuses(),this.loadDrivers()}loadRoutes(){this.isLoading=!0,this.errorMessage="",this.cdr.detectChanges(),this.routeService.getAll().subscribe({next:r=>{r.isSuccess&&r.data?this.routes=r.data:(this.errorMessage=r.message||"Veri y\xFCklenemedi",this.routes=[]),this.isLoading=!1,this.cdr.detectChanges()},error:r=>{console.error("Error loading routes:",r),this.errorMessage="Rotalar y\xFCklenirken bir hata olu\u015Ftu",this.isLoading=!1,this.routes=[],this.cdr.detectChanges()}})}loadBuses(){this.busService.getAll().subscribe({next:r=>{r.isSuccess&&r.data&&(this.buses=r.data)},error:r=>{console.error("Error loading buses:",r)}})}loadDrivers(){this.driverService.getAll().subscribe({next:r=>{r.isSuccess&&r.data&&(this.drivers=r.data)},error:r=>{console.error("Error loading drivers:",r)}})}openAddModal(){this.isEditMode=!1,this.selectedRouteId=null,this.routeForm.reset(),this.isModalOpen=!0,this.errorMessage="",this.successMessage="",this.cdr.detectChanges()}openEditModal(r){this.isEditMode=!0,this.selectedRouteId=r.id,this.routeForm.reset(),this.routeForm.patchValue({name:r.name,startPoint:r.startPoint,endPoint:r.endPoint,morningStartTime:this.formatTimeForInput(r.morningStartTime),eveningStartTime:this.formatTimeForInput(r.eveningStartTime),busId:r.busId,driverId:r.driverId}),this.isModalOpen=!0,this.errorMessage="",this.successMessage="",this.cdr.detectChanges()}closeModal(){this.isModalOpen=!1,this.routeForm.reset(),this.errorMessage="",this.successMessage="",this.selectedRouteId=null,this.cdr.detectChanges()}onSubmit(){if(this.routeForm.invalid){this.routeForm.markAllAsTouched();return}this.isLoading=!0,this.errorMessage="",this.successMessage="",this.cdr.detectChanges();let r=this.routeForm.getRawValue(),e={name:r.name?.trim()||"",startPoint:r.startPoint?.trim()||"",endPoint:r.endPoint?.trim()||"",morningStartTime:r.morningStartTime+":00",eveningStartTime:r.eveningStartTime+":00",busId:r.busId,driverId:r.driverId};if(this.isEditMode&&this.selectedRouteId){let l=R({id:this.selectedRouteId},e);this.routeService.update(l).subscribe({next:s=>{this.isLoading=!1,s.isSuccess?(this.successMessage="Rota ba\u015Far\u0131yla g\xFCncellendi!",this.cdr.detectChanges(),setTimeout(()=>{this.loadRoutes(),this.closeModal()},1e3)):(this.errorMessage=s.message||"G\xFCncelleme ba\u015Far\u0131s\u0131z",this.cdr.detectChanges())},error:s=>{console.error("Update Error:",s),this.errorMessage=s.error?.message||"Rota g\xFCncellenirken bir hata olu\u015Ftu",this.isLoading=!1,this.cdr.detectChanges()}})}else this.routeService.create(e).subscribe({next:l=>{this.isLoading=!1,l.isSuccess?(this.successMessage="Rota ba\u015Far\u0131yla eklendi!",this.cdr.detectChanges(),setTimeout(()=>{this.loadRoutes(),this.closeModal()},1e3)):(this.errorMessage=l.message||"Ekleme ba\u015Far\u0131s\u0131z",this.cdr.detectChanges())},error:l=>{console.error("Create Error:",l),this.errorMessage=l.error?.message||"Rota eklenirken bir hata olu\u015Ftu",this.isLoading=!1,this.cdr.detectChanges()}})}openDetailModal(r){this.selectedRoute=r,this.isDetailModalOpen=!0,this.routeStops=[],this.cdr.detectChanges(),this.loadRouteStops(r.id),setTimeout(()=>{this.initMap()},100)}closeDetailModal(){this.isDetailModalOpen=!1,this.selectedRoute=null,this.routeStops=[],this.map&&(this.map.remove(),this.map=null),this.cdr.detectChanges()}loadRouteStops(r){this.isLoadingStops=!0,this.routeService.getRouteStops(r).subscribe({next:e=>{e.isSuccess&&e.data&&(this.routeStops=e.data.sort((l,s)=>l.sequenceNumber-s.sequenceNumber),this.updateMapMarkers()),this.isLoadingStops=!1,this.cdr.detectChanges()},error:e=>{console.error("Error loading stops:",e),this.isLoadingStops=!1,this.cdr.detectChanges()}})}initMap(){document.getElementById("route-map")&&(this.map=f.map("route-map").setView([41.0082,28.9784],11),f.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map),this.updateMapMarkers())}updateMapMarkers(){if(!this.map||this.routeStops.length===0)return;this.map.eachLayer(e=>{(e instanceof f.Marker||e instanceof f.Polyline)&&this.map?.removeLayer(e)});let r=[];if(this.routeStops.forEach((e,l)=>{let s=Number(e.latitude),b=Number(e.longitude);r.push([s,b]);let w="blue";l===0&&(w="green"),l===this.routeStops.length-1&&(w="red");let C=f.divIcon({className:"custom-marker",html:`
          <div style="background-color: ${w}; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">
            ${e.sequenceNumber}
          </div>
        `,iconSize:[30,30],iconAnchor:[15,15]});f.marker([s,b],{icon:C}).addTo(this.map).bindPopup(`
        <div style="min-width: 200px;">
          <h3 style="font-weight: bold; margin-bottom: 8px;">Durak ${e.sequenceNumber}</h3>
          <p style="margin: 4px 0;"><strong>Adres:</strong> ${e.address}</p>
          <p style="margin: 4px 0;"><strong>\u0130l\xE7e:</strong> ${e.district}, ${e.city}</p>
          <hr style="margin: 8px 0;">
          <p style="margin: 4px 0;"><strong>Sabah:</strong> ${this.formatTime(e.estimatedArrivalTimeMorning)}</p>
          <p style="margin: 4px 0;"><strong>Ak\u015Fam:</strong> ${this.formatTime(e.estimatedArrivalTimeEvening)}</p>
        </div>
      `)}),r.length>1){let e=f.polyline(r,{color:"#3b82f6",weight:4,opacity:.7}).addTo(this.map);this.map.fitBounds(e.getBounds(),{padding:[50,50]})}else r.length===1&&this.map.setView(r[0],15)}openDeleteModal(r){this.routeToDelete=r,this.isDeleteModalOpen=!0,this.cdr.detectChanges()}closeDeleteModal(){this.isDeleteModalOpen=!1,this.routeToDelete=null,this.cdr.detectChanges()}confirmDelete(){this.routeToDelete&&(this.isDeleting=!0,this.cdr.detectChanges(),this.routeService.delete(this.routeToDelete.id).subscribe({next:r=>{r.isSuccess?(this.successMessage="Rota ba\u015Far\u0131yla silindi!",this.loadRoutes(),setTimeout(()=>{this.successMessage="",this.cdr.detectChanges()},3e3)):this.errorMessage=r.message||"Silme i\u015Flemi ba\u015Far\u0131s\u0131z",this.isDeleting=!1,this.closeDeleteModal()},error:r=>{this.errorMessage=r.error?.message||"Rota silinirken bir hata olu\u015Ftu",this.isDeleting=!1,this.closeDeleteModal()}}))}formatTime(r){return r?r.substring(0,5):"-"}formatTimeForInput(r){return r?r.substring(0,5):""}getStopCount(r){return r.routeStops?.length||0}getBusName(r){let e=this.buses.find(l=>l.id===r);return e?e.plateNo:"Bilinmiyor"}getDriverName(r){let e=this.drivers.find(l=>l.id===r);return e?`${e.firstName} ${e.lastName}`:"Bilinmiyor"}getErrorMessage(r){let e=this.routeForm.get(r);return e?.hasError("required")?"Bu alan zorunludur":e?.hasError("minlength")?"En az 3 karakter olmal\u0131d\u0131r":""}static \u0275fac=function(e){return new(e||n)(M(J),M(W),M(Q),M(U),M(D))};static \u0275cmp=F({type:n,selectors:[["app-routes"]],decls:18,vars:8,consts:[[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-gray-800","dark:text-white"],[1,"text-gray-600","dark:text-gray-400","mt-1"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["class","bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-400 px-4 py-3 rounded-lg flex items-center gap-2 animate-fade-in",4,"ngIf"],["class","bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded-lg flex items-center gap-2",4,"ngIf"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",4,"ngIf"],["class","fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",4,"ngIf"],[1,"bg-green-50","dark:bg-green-900/30","border","border-green-200","dark:border-green-800","text-green-700","dark:text-green-400","px-4","py-3","rounded-lg","flex","items-center","gap-2","animate-fade-in"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"bg-red-50","dark:bg-red-900/30","border","border-red-200","dark:border-red-800","text-red-700","dark:text-red-400","px-4","py-3","rounded-lg","flex","items-center","gap-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","justify-center","items-center","py-12"],[1,"flex","flex-col","items-center","gap-3"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-10","w-10","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-gray-600","dark:text-gray-400"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-sm","border","border-gray-200","dark:border-gray-700","overflow-hidden"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-gray-50","dark:bg-gray-700/50","border-b","border-gray-200","dark:border-gray-700"],[1,"px-6","py-4","text-left","text-xs","font-semibold","text-gray-600","dark:text-gray-300","uppercase","tracking-wider"],[1,"px-6","py-4","text-right","text-xs","font-semibold","text-gray-600","dark:text-gray-300","uppercase","tracking-wider"],[1,"divide-y","divide-gray-200","dark:divide-gray-700"],["class","hover:bg-gray-50 dark:hover:bg-gray-700/30 transition",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50","dark:hover:bg-gray-700/30","transition"],[1,"px-6","py-4"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-lg","bg-orange-100","dark:bg-orange-900/30","flex","items-center","justify-center","flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-orange-600","dark:text-orange-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],[1,"font-bold","text-gray-800","dark:text-white"],[1,"flex","flex-col","gap-1"],[1,"flex","items-center","gap-2","text-sm","text-gray-600","dark:text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-600","dark:text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-red-600","dark:text-red-400"],[1,"flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-orange-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"],[1,"text-sm","font-medium","text-gray-800","dark:text-white"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-indigo-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","dark:bg-green-900/30","text-green-800","dark:text-green-400"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-indigo-100","dark:bg-indigo-900/30","text-indigo-800","dark:text-indigo-400"],[1,"inline-flex","items-center","gap-2","px-3","py-1.5","bg-blue-100","dark:bg-blue-900/30","text-blue-800","dark:text-blue-400","rounded-lg","hover:bg-blue-200","dark:hover:bg-blue-900/50","transition","text-sm","font-medium",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],[1,"px-6","py-4","text-right"],[1,"flex","items-center","justify-end","gap-2"],["title","D\xFCzenle",1,"p-2","text-blue-600","dark:text-blue-400","hover:bg-blue-50","dark:hover:bg-blue-900/30","rounded-lg","transition","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Sil",1,"p-2","text-red-600","dark:text-red-400","hover:bg-red-50","dark:hover:bg-red-900/30","rounded-lg","transition","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-400","dark:text-gray-600","mx-auto","mb-4"],[1,"text-lg","font-medium","text-gray-800","dark:text-white","mb-2"],[1,"text-gray-600","dark:text-gray-400","mb-4"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition",3,"click"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4","bg-black/50","backdrop-blur-sm"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","dark:border-gray-700","sticky","top-0","bg-white","dark:bg-gray-800","z-10"],[1,"text-2xl","font-bold","text-gray-800","dark:text-white"],["title","Kapat",1,"text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","transition","disabled:opacity-50",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],["class","mb-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-400 px-4 py-3 rounded-lg flex items-center gap-2 animate-fade-in",4,"ngIf"],["class","mb-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded-lg flex items-center gap-2",4,"ngIf"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-red-500"],["type","text","formControlName","name","placeholder","\xD6rn: Kad\u0131k\xF6y - Ata\u015Fehir Hatt\u0131",1,"w-full","px-4","py-2.5","bg-gray-50","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","outline-none","text-gray-800","dark:text-white","transition"],["class","text-red-500 text-xs mt-1.5 flex items-center gap-1",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","text","formControlName","startPoint","placeholder","\xD6rn: Kad\u0131k\xF6y Meydan\u0131",1,"w-full","px-4","py-2.5","bg-gray-50","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","outline-none","text-gray-800","dark:text-white","transition"],["type","text","formControlName","endPoint","placeholder","\xD6rn: Ata\u015Fehir Metro",1,"w-full","px-4","py-2.5","bg-gray-50","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","outline-none","text-gray-800","dark:text-white","transition"],["type","time","formControlName","morningStartTime",1,"w-full","px-4","py-2.5","bg-gray-50","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","outline-none","text-gray-800","dark:text-white","transition"],["type","time","formControlName","eveningStartTime",1,"w-full","px-4","py-2.5","bg-gray-50","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","outline-none","text-gray-800","dark:text-white","transition"],["formControlName","busId",1,"w-full","px-4","py-2.5","bg-gray-50","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","outline-none","text-gray-800","dark:text-white","transition"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","driverId",1,"w-full","px-4","py-2.5","bg-gray-50","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","outline-none","text-gray-800","dark:text-white","transition"],[1,"flex","items-center","justify-end","gap-3","pt-6","border-t","border-gray-200","dark:border-gray-700"],["type","button",1,"px-6","py-2.5","bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-white","rounded-lg","hover:bg-gray-300","dark:hover:bg-gray-600","transition","disabled:opacity-50","disabled:cursor-not-allowed","font-medium",3,"click","disabled"],["type","submit",1,"px-6","py-2.5","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition","disabled:bg-gray-400","disabled:cursor-not-allowed","flex","items-center","gap-2","font-medium",3,"disabled"],["class","animate-spin h-5 w-5","fill","none","viewBox","0 0 24 24",4,"ngIf"],[1,"mb-4","bg-green-50","dark:bg-green-900/30","border","border-green-200","dark:border-green-800","text-green-700","dark:text-green-400","px-4","py-3","rounded-lg","flex","items-center","gap-2","animate-fade-in"],[1,"mb-4","bg-red-50","dark:bg-red-900/30","border","border-red-200","dark:border-red-800","text-red-700","dark:text-red-400","px-4","py-3","rounded-lg","flex","items-center","gap-2"],[1,"text-red-500","text-xs","mt-1.5","flex","items-center","gap-1"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[3,"value"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-7xl","w-full","h-[90vh]","flex","flex-col"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","dark:border-gray-700","flex-shrink-0"],[1,"text-gray-600","dark:text-gray-400","text-sm","mt-1"],["title","Kapat",1,"text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","transition",3,"click"],[1,"flex-1","flex","overflow-hidden"],[1,"flex-1","relative"],["id","route-map",1,"absolute","inset-0"],["class","absolute inset-0 bg-white/80 dark:bg-gray-800/80 flex items-center justify-center backdrop-blur-sm",4,"ngIf"],[1,"w-96","border-l","border-gray-200","dark:border-gray-700","overflow-y-auto","bg-gray-50","dark:bg-gray-900","p-6"],[1,"text-lg","font-bold","text-gray-800","dark:text-white","mb-4","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["class","text-center py-8 text-gray-500 dark:text-gray-400",4,"ngIf"],[1,"space-y-3"],["class","bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700 hover:shadow-md transition",4,"ngFor","ngForOf"],[1,"absolute","inset-0","bg-white/80","dark:bg-gray-800/80","flex","items-center","justify-center","backdrop-blur-sm"],[1,"text-center","py-8","text-gray-500","dark:text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","mb-3","opacity-50"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","border","border-gray-200","dark:border-gray-700","hover:shadow-md","transition"],[1,"flex","items-start","gap-3"],[1,"flex-shrink-0","w-8","h-8","rounded-full","flex","items-center","justify-center","font-bold","text-white",3,"ngClass"],[1,"flex-1","min-w-0"],[1,"font-medium","text-gray-800","dark:text-white","text-sm"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1"],[1,"flex","items-center","gap-3","mt-2","text-xs"],[1,"flex","items-center","gap-1","text-orange-600","dark:text-orange-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],[1,"flex","items-center","gap-1","text-indigo-600","dark:text-indigo-400"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-md","w-full","transform","transition-all"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","dark:border-gray-700"],[1,"flex-shrink-0","w-12","h-12","bg-red-100","dark:bg-red-900/30","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-600","dark:text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-xl","font-bold","text-gray-800","dark:text-white"],[1,"text-gray-600","dark:text-gray-400","mb-2"],[1,"font-semibold","text-gray-800","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-500"],[1,"flex","items-center","justify-end","gap-3","p-6","bg-gray-50","dark:bg-gray-700/50","rounded-b-xl"],["type","button",1,"px-6","py-2.5","bg-white","dark:bg-gray-700","text-gray-800","dark:text-white","border","border-gray-300","dark:border-gray-600","rounded-lg","hover:bg-gray-50","dark:hover:bg-gray-600","transition","disabled:opacity-50","disabled:cursor-not-allowed","font-medium",3,"click","disabled"],["type","button",1,"px-6","py-2.5","bg-red-600","text-white","rounded-lg","hover:bg-red-700","transition","disabled:bg-gray-400","disabled:cursor-not-allowed","flex","items-center","gap-2","font-medium",3,"click","disabled"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"]],template:function(e,l){e&1&&(t(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),a(4,"Rotalar"),i(),t(5,"p",3),a(6,"T\xFCm rotalar\u0131 g\xF6r\xFCnt\xFCleyin ve y\xF6netin"),i()(),t(7,"button",4),y("click",function(){return l.openAddModal()}),u(),t(8,"svg",5),d(9,"path",6),i(),a(10," Yeni Rota "),i()(),x(11,re,5,1,"div",7)(12,ne,5,1,"div",8)(13,ae,7,0,"div",9)(14,se,24,2,"div",10),i(),x(15,ke,76,18,"div",11)(16,Ce,24,7,"div",11)(17,Ie,26,7,"div",11)),e&2&&(o(7),m("disabled",l.isLoading),o(4),m("ngIf",l.successMessage&&!l.isModalOpen&&!l.isDetailModalOpen),o(),m("ngIf",l.errorMessage&&!l.isModalOpen&&!l.isDetailModalOpen),o(),m("ngIf",l.isLoading&&!l.isModalOpen),o(),m("ngIf",!l.isLoading),o(),m("ngIf",l.isModalOpen),o(),m("ngIf",l.isDetailModalOpen),o(),m("ngIf",l.isDeleteModalOpen))},dependencies:[N,O,B,G,Z,H,K,Y,P,q,j,z,$,A],styles:["@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .3s ease-out}#route-map[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:0}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e0;border-radius:4px}.dark[_ngcontent-%COMP%]   .overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4a5568}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a0aec0}.dark[_ngcontent-%COMP%]   .overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#718096}.leaflet-popup-content-wrapper[_ngcontent-%COMP%]{border-radius:8px}.leaflet-popup-content[_ngcontent-%COMP%]{margin:12px}"]})};export{X as RoutesComponent};
